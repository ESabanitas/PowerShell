# Import Exchange Online module
Import-Module ExchangeOnlineManagement

# Connect to Exchange Online using admin credentials
Connect-ExchangeOnline -Credential (Get-Credential)

# Define the path of CSV file containing contact details
$filePath = "C:\O365App\altacontactos\contactos.csv"

# Import CSV file and create contacts
$contacts = Import-Csv $filePath
foreach ($contact in $contacts) {
    New-MailContact -Name $contact.Name -ExternalEmailAddress $contact.Email
}

# Disconnect from Exchange Online
Disconnect-ExchangeOnline -Confirm:$false
